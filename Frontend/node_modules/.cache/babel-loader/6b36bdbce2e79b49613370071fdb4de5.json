{"ast":null,"code":"'use strict';\n\nvar _slicedToArray = function () {\n  function sliceIterator(arr, i) {\n    var _arr = [];\n    var _n = true;\n    var _d = false;\n    var _e = undefined;\n\n    try {\n      for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) {\n        _arr.push(_s.value);\n\n        if (i && _arr.length === i) break;\n      }\n    } catch (err) {\n      _d = true;\n      _e = err;\n    } finally {\n      try {\n        if (!_n && _i[\"return\"]) _i[\"return\"]();\n      } finally {\n        if (_d) throw _e;\n      }\n    }\n\n    return _arr;\n  }\n\n  return function (arr, i) {\n    if (Array.isArray(arr)) {\n      return arr;\n    } else if (Symbol.iterator in Object(arr)) {\n      return sliceIterator(arr, i);\n    } else {\n      throw new TypeError(\"Invalid attempt to destructure non-iterable instance\");\n    }\n  };\n}();\n\nvar _extends = Object.assign || function (target) {\n  for (var i = 1; i < arguments.length; i++) {\n    var source = arguments[i];\n\n    for (var key in source) {\n      if (Object.prototype.hasOwnProperty.call(source, key)) {\n        target[key] = source[key];\n      }\n    }\n  }\n\n  return target;\n};\n\nvar _createClass = function () {\n  function defineProperties(target, props) {\n    for (var i = 0; i < props.length; i++) {\n      var descriptor = props[i];\n      descriptor.enumerable = descriptor.enumerable || false;\n      descriptor.configurable = true;\n      if (\"value\" in descriptor) descriptor.writable = true;\n      Object.defineProperty(target, descriptor.key, descriptor);\n    }\n  }\n\n  return function (Constructor, protoProps, staticProps) {\n    if (protoProps) defineProperties(Constructor.prototype, protoProps);\n    if (staticProps) defineProperties(Constructor, staticProps);\n    return Constructor;\n  };\n}();\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _possibleConstructorReturn(self, call) {\n  if (!self) {\n    throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\");\n  }\n\n  return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self;\n}\n\nfunction _inherits(subClass, superClass) {\n  if (typeof superClass !== \"function\" && superClass !== null) {\n    throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass);\n  }\n\n  subClass.prototype = Object.create(superClass && superClass.prototype, {\n    constructor: {\n      value: subClass,\n      enumerable: false,\n      writable: true,\n      configurable: true\n    }\n  });\n  if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass;\n}\n\nvar fs = require('fs');\n\nvar _require = require('path'),\n    extname = _require.extname,\n    basename = _require.basename;\n\nvar Q = require('q');\n\nvar Writable = require(\"stream\").Writable;\n\nvar urlLib = require('url'); // eslint-disable-next-line import/order\n\n\nvar _require2 = require(\"./config\"),\n    upload_prefix = _require2.upload_prefix;\n\nvar isSecure = !(upload_prefix && upload_prefix.slice(0, 5) === 'http:');\nvar https = isSecure ? require('https') : require('http');\n\nvar Cache = require('./cache');\n\nvar utils = require(\"./utils\");\n\nvar UploadStream = require('./upload_stream');\n\nvar build_upload_params = utils.build_upload_params,\n    extend = utils.extend,\n    includes = utils.includes,\n    isObject = utils.isObject,\n    isRemoteUrl = utils.isRemoteUrl,\n    merge = utils.merge,\n    pickOnlyExistingValues = utils.pickOnlyExistingValues;\n\nexports.unsigned_upload_stream = function unsigned_upload_stream(upload_preset, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return exports.upload_stream(callback, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n\nexports.upload_stream = function upload_stream(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return exports.upload(null, callback, extend({\n    stream: true\n  }, options));\n};\n\nexports.unsigned_upload = function unsigned_upload(file, upload_preset, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return exports.upload(file, callback, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n\nexports.upload = function upload(file, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"upload\", callback, options, function () {\n    var params = build_upload_params(options);\n    return isRemoteUrl(file) ? [params, {\n      file: file\n    }] : [params, {}, file];\n  });\n};\n\nexports.upload_large = function upload_large(path, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (path != null && isRemoteUrl(path)) {\n    // upload a remote file\n    return exports.upload(path, callback, options);\n  }\n\n  if (path != null && !options.filename) {\n    options.filename = path.split(/(\\\\|\\/)/g).pop().replace(/\\.[^/.]+$/, \"\");\n  }\n\n  return exports.upload_chunked(path, callback, extend({\n    resource_type: 'raw'\n  }, options));\n};\n\nexports.upload_chunked = function upload_chunked(path, callback, options) {\n  var file_reader = fs.createReadStream(path);\n  var out_stream = exports.upload_chunked_stream(callback, options);\n  return file_reader.pipe(out_stream);\n};\n\nvar Chunkable = function (_Writable) {\n  _inherits(Chunkable, _Writable);\n\n  function Chunkable(options) {\n    _classCallCheck(this, Chunkable);\n\n    var _this = _possibleConstructorReturn(this, (Chunkable.__proto__ || Object.getPrototypeOf(Chunkable)).call(this, options));\n\n    _this.chunk_size = options.chunk_size != null ? options.chunk_size : 20000000;\n    _this.buffer = Buffer.alloc(0);\n    _this.active = true;\n\n    _this.on('finish', function () {\n      if (_this.active) {\n        _this.emit('ready', _this.buffer, true, function () {});\n      }\n    });\n\n    return _this;\n  }\n\n  _createClass(Chunkable, [{\n    key: '_write',\n    value: function _write(data, encoding, done) {\n      var _this2 = this;\n\n      if (!this.active) {\n        done();\n      }\n\n      if (this.buffer.length + data.length <= this.chunk_size) {\n        this.buffer = Buffer.concat([this.buffer, data], this.buffer.length + data.length);\n        done();\n      } else {\n        var grab = this.chunk_size - this.buffer.length;\n        this.buffer = Buffer.concat([this.buffer, data.slice(0, grab)], this.buffer.length + grab);\n        this.emit('ready', this.buffer, false, function (active) {\n          _this2.active = active;\n\n          if (_this2.active) {\n            _this2.buffer = data.slice(grab);\n            done();\n          }\n        });\n      }\n    }\n  }]);\n\n  return Chunkable;\n}(Writable);\n\nexports.upload_large_stream = function upload_large_stream(_unused_, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return exports.upload_chunked_stream(callback, extend({\n    resource_type: 'raw'\n  }, options));\n};\n\nexports.upload_chunked_stream = function upload_chunked_stream(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  options = extend({}, options, {\n    stream: true\n  });\n  options.x_unique_upload_id = utils.random_public_id();\n  var params = build_upload_params(options);\n  var chunk_size = options.chunk_size != null ? options.chunk_size : options.part_size;\n  var chunker = new Chunkable({\n    chunk_size: chunk_size\n  });\n  var sent = 0;\n  chunker.on('ready', function (buffer, is_last, done) {\n    var chunk_start = sent;\n    sent += buffer.length;\n    options.content_range = `bytes ${chunk_start}-${sent - 1}/${is_last ? sent : -1}`;\n    params.timestamp = utils.timestamp();\n\n    var finished_part = function finished_part(result) {\n      var errorOrLast = result.error != null || is_last;\n\n      if (errorOrLast && typeof callback === \"function\") {\n        callback(result);\n      }\n\n      return done(!errorOrLast);\n    };\n\n    var stream = call_api(\"upload\", finished_part, options, function () {\n      return [params, {}, buffer];\n    });\n    return stream.write(buffer, 'buffer', function () {\n      return stream.end();\n    });\n  });\n  return chunker;\n};\n\nexports.explicit = function explicit(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"explicit\", callback, options, function () {\n    return utils.build_explicit_api_params(public_id, options);\n  });\n}; // Creates a new archive in the server and returns information in JSON format\n\n\nexports.create_archive = function create_archive(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var target_format = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n  return call_api(\"generate_archive\", callback, options, function () {\n    var opt = utils.archive_params(options);\n\n    if (target_format) {\n      opt.target_format = target_format;\n    }\n\n    return [opt];\n  });\n}; // Creates a new zip archive in the server and returns information in JSON format\n\n\nexports.create_zip = function create_zip(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  return exports.create_archive(callback, options, \"zip\");\n};\n\nexports.destroy = function destroy(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"destroy\", callback, options, function () {\n    return [{\n      timestamp: utils.timestamp(),\n      type: options.type,\n      invalidate: options.invalidate,\n      public_id: public_id\n    }];\n  });\n};\n\nexports.rename = function rename(from_public_id, to_public_id, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return call_api(\"rename\", callback, options, function () {\n    return [{\n      timestamp: utils.timestamp(),\n      type: options.type,\n      from_public_id: from_public_id,\n      to_public_id: to_public_id,\n      overwrite: options.overwrite,\n      invalidate: options.invalidate,\n      to_type: options.to_type\n    }];\n  });\n};\n\nvar TEXT_PARAMS = [\"public_id\", \"font_family\", \"font_size\", \"font_color\", \"text_align\", \"font_weight\", \"font_style\", \"background\", \"opacity\", \"text_decoration\", \"font_hinting\", \"font_antialiasing\"];\n\nexports.text = function text(content, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"text\", callback, options, function () {\n    var textParams = pickOnlyExistingValues.apply(undefined, [options].concat(TEXT_PARAMS));\n\n    var params = _extends({\n      timestamp: utils.timestamp(),\n      text: content\n    }, textParams);\n\n    return [params];\n  });\n};\n\nexports.generate_sprite = function generate_sprite(tag, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"sprite\", callback, options, function () {\n    var transformation = utils.generate_transformation_string(extend({}, options, {\n      fetch_format: options.format\n    }));\n    return [{\n      timestamp: utils.timestamp(),\n      tag: tag,\n      transformation: transformation,\n      async: options.async,\n      notification_url: options.notification_url\n    }];\n  });\n};\n\nexports.multi = function multi(tag, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"multi\", callback, options, function () {\n    var transformation = utils.generate_transformation_string(extend({}, options));\n    return [{\n      timestamp: utils.timestamp(),\n      tag: tag,\n      transformation: transformation,\n      format: options.format,\n      async: options.async,\n      notification_url: options.notification_url\n    }];\n  });\n};\n\nexports.explode = function explode(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_api(\"explode\", callback, options, function () {\n    var transformation = utils.generate_transformation_string(extend({}, options));\n    return [{\n      timestamp: utils.timestamp(),\n      public_id: public_id,\n      transformation: transformation,\n      format: options.format,\n      type: options.type,\n      notification_url: options.notification_url\n    }];\n  });\n}; // options may include 'exclusive' (boolean) which causes clearing this tag from all other resources\n\n\nexports.add_tag = function add_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  var exclusive = utils.option_consume(\"exclusive\", options);\n  var command = exclusive ? \"set_exclusive\" : \"add\";\n  return call_tags_api(tag, command, public_ids, callback, options);\n};\n\nexports.remove_tag = function remove_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return call_tags_api(tag, \"remove\", public_ids, callback, options);\n};\n\nexports.remove_all_tags = function remove_all_tags() {\n  var public_ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var callback = arguments[1];\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_tags_api(null, \"remove_all\", public_ids, callback, options);\n};\n\nexports.replace_tag = function replace_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return call_tags_api(tag, \"replace\", public_ids, callback, options);\n};\n\nfunction call_tags_api(tag, command) {\n  var public_ids = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var callback = arguments[3];\n  var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n  return call_api(\"tags\", callback, options, function () {\n    var params = {\n      timestamp: utils.timestamp(),\n      public_ids: utils.build_array(public_ids),\n      command: command,\n      type: options.type\n    };\n\n    if (tag != null) {\n      params.tag = tag;\n    }\n\n    return [params];\n  });\n}\n\nexports.add_context = function add_context(context) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return call_context_api(context, 'add', public_ids, callback, options);\n};\n\nexports.remove_all_context = function remove_all_context() {\n  var public_ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var callback = arguments[1];\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return call_context_api(null, 'remove_all', public_ids, callback, options);\n};\n\nfunction call_context_api(context, command) {\n  var public_ids = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var callback = arguments[3];\n  var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n  return call_api('context', callback, options, function () {\n    var params = {\n      timestamp: utils.timestamp(),\n      public_ids: utils.build_array(public_ids),\n      command: command,\n      type: options.type\n    };\n\n    if (context != null) {\n      params.context = utils.encode_context(context);\n    }\n\n    return [params];\n  });\n}\n/**\n * Cache (part of) the upload results.\n * @param result\n * @param {object} options\n * @param {string} options.type\n * @param {string} options.resource_type\n */\n\n\nfunction cacheResults(result, _ref) {\n  var type = _ref.type,\n      resource_type = _ref.resource_type;\n\n  if (result.responsive_breakpoints) {\n    result.responsive_breakpoints.forEach(function (_ref2) {\n      var transformation = _ref2.transformation,\n          url = _ref2.url,\n          breakpoints = _ref2.breakpoints;\n      return Cache.set(result.public_id, {\n        type,\n        resource_type,\n        raw_transformation: transformation,\n        format: extname(breakpoints[0].url).slice(1)\n      }, breakpoints.map(function (i) {\n        return i.width;\n      }));\n    });\n  }\n}\n\nfunction parseResult(buffer, res) {\n  var result = '';\n\n  try {\n    result = JSON.parse(buffer);\n\n    if (result.error && !result.error.name) {\n      result.error.name = \"Error\";\n    }\n  } catch (jsonError) {\n    result = {\n      error: {\n        message: `Server return invalid JSON response. Status Code ${res.statusCode}. ${jsonError}`,\n        name: \"Error\"\n      }\n    };\n  }\n\n  return result;\n}\n\nfunction call_api(action, callback, options, get_params) {\n  if (typeof callback !== \"function\") {\n    callback = function callback() {};\n  }\n\n  var deferred = Q.defer();\n\n  if (options == null) {\n    options = {};\n  }\n\n  var _get_params$call = get_params.call(),\n      _get_params$call2 = _slicedToArray(_get_params$call, 3),\n      params = _get_params$call2[0],\n      unsigned_params = _get_params$call2[1],\n      file = _get_params$call2[2];\n\n  params = utils.process_request_params(params, options);\n  params = extend(params, unsigned_params);\n  var api_url = utils.api_url(action, options);\n  var boundary = utils.random_public_id();\n  var errorRaised = false;\n\n  var handle_response = function handle_response(res) {\n    // let buffer;\n    if (errorRaised) {// Already reported\n    } else if (res.error) {\n      errorRaised = true;\n      deferred.reject(res);\n      callback(res);\n    } else if (includes([200, 400, 401, 404, 420, 500], res.statusCode)) {\n      var buffer = \"\";\n      res.on(\"data\", function (d) {\n        buffer += d;\n        return buffer;\n      });\n      res.on(\"end\", function () {\n        var result = void 0;\n\n        if (errorRaised) {\n          return;\n        }\n\n        result = parseResult(buffer, res);\n\n        if (result.error) {\n          result.error.http_code = res.statusCode;\n          deferred.reject(result.error);\n        } else {\n          cacheResults(result, options);\n          deferred.resolve(result);\n        }\n\n        callback(result);\n      });\n      res.on(\"error\", function (error) {\n        errorRaised = true;\n        deferred.reject(error);\n        callback({\n          error\n        });\n      });\n    } else {\n      var error = {\n        message: `Server returned unexpected status code - ${res.statusCode}`,\n        http_code: res.statusCode,\n        name: \"UnexpectedResponse\"\n      };\n      deferred.reject(error);\n      callback({\n        error\n      });\n    }\n  };\n\n  var post_data = utils.hashToParameters(params).filter(function (_ref3) {\n    var _ref4 = _slicedToArray(_ref3, 2),\n        key = _ref4[0],\n        value = _ref4[1];\n\n    return value != null;\n  }).map(function (_ref5) {\n    var _ref6 = _slicedToArray(_ref5, 2),\n        key = _ref6[0],\n        value = _ref6[1];\n\n    return Buffer.from(encodeFieldPart(boundary, key, value), 'utf8');\n  });\n  var result = post(api_url, post_data, boundary, file, handle_response, options);\n\n  if (isObject(result)) {\n    return result;\n  }\n\n  return deferred.promise;\n}\n\nfunction post(url, post_data, boundary, file, callback, options) {\n  var file_header = void 0;\n  var finish_buffer = Buffer.from(\"--\" + boundary + \"--\", 'ascii');\n\n  if (file != null || options.stream) {\n    // eslint-disable-next-line no-nested-ternary\n    var filename = options.stream ? options.filename ? options.filename : \"file\" : basename(file);\n    file_header = Buffer.from(encodeFilePart(boundary, 'application/octet-stream', 'file', filename), 'binary');\n  }\n\n  var post_options = urlLib.parse(url);\n  var headers = {\n    'Content-Type': `multipart/form-data; boundary=${boundary}`,\n    'User-Agent': utils.getUserAgent()\n  };\n\n  if (options.content_range != null) {\n    headers['Content-Range'] = options.content_range;\n  }\n\n  if (options.x_unique_upload_id != null) {\n    headers['X-Unique-Upload-Id'] = options.x_unique_upload_id;\n  }\n\n  post_options = extend(post_options, {\n    method: 'POST',\n    headers: headers\n  });\n\n  if (options.agent != null) {\n    post_options.agent = options.agent;\n  }\n\n  var post_request = https.request(post_options, callback);\n  var upload_stream = new UploadStream({\n    boundary\n  });\n  upload_stream.pipe(post_request);\n  var timeout = false;\n  post_request.on(\"error\", function (error) {\n    if (timeout) {\n      error = {\n        message: \"Request Timeout\",\n        http_code: 499,\n        name: \"TimeoutError\"\n      };\n    }\n\n    return callback({\n      error\n    });\n  });\n  post_request.setTimeout(options.timeout != null ? options.timeout : 60000, function () {\n    timeout = true;\n    return post_request.abort();\n  });\n  post_data.forEach(function (postDatum) {\n    return post_request.write(postDatum);\n  });\n\n  if (options.stream) {\n    post_request.write(file_header);\n    return upload_stream;\n  }\n\n  if (file != null) {\n    post_request.write(file_header);\n    fs.createReadStream(file).on('error', function (error) {\n      callback({\n        error: error\n      });\n      return post_request.abort();\n    }).pipe(upload_stream);\n  } else {\n    post_request.write(finish_buffer);\n    post_request.end();\n  }\n\n  return true;\n}\n\nfunction encodeFieldPart(boundary, name, value) {\n  return [`--${boundary}`, `Content-Disposition: form-data; name=\"${name}\"`, '', value, ''].join(\"\\r\\n\");\n}\n\nfunction encodeFilePart(boundary, type, name, filename) {\n  return [`--${boundary}`, `Content-Disposition: form-data; name=\"${name}\"; filename=\"${filename}\"`, `Content-Type: ${type}`, '', ''].join(\"\\r\\n\");\n}\n\nexports.direct_upload = function direct_upload(callback_url) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var params = build_upload_params(extend({\n    callback: callback_url\n  }, options));\n  params = utils.process_request_params(params, options);\n  var api_url = utils.api_url(\"upload\", options);\n  return {\n    hidden_fields: params,\n    form_attrs: {\n      action: api_url,\n      method: \"POST\",\n      enctype: \"multipart/form-data\"\n    }\n  };\n};\n\nexports.upload_tag_params = function upload_tag_params() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n  var params = build_upload_params(options);\n  params = utils.process_request_params(params, options);\n  return JSON.stringify(params);\n};\n\nexports.upload_url = function upload_url() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  if (options.resource_type == null) {\n    options.resource_type = \"auto\";\n  }\n\n  return utils.api_url(\"upload\", options);\n};\n\nexports.image_upload_tag = function image_upload_tag(field) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var html_options = options.html || {};\n  var tag_options = extend({\n    type: \"file\",\n    name: \"file\",\n    \"data-url\": exports.upload_url(options),\n    \"data-form-data\": exports.upload_tag_params(options),\n    \"data-cloudinary-field\": field,\n    \"data-max-chunk-size\": options.chunk_size,\n    \"class\": [html_options.class, \"cloudinary-fileupload\"].join(\" \")\n  }, html_options);\n  return `<input ${utils.html_attrs(tag_options)}/>`;\n};\n\nexports.unsigned_image_upload_tag = function unsigned_image_upload_tag(field, upload_preset) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n  return exports.image_upload_tag(field, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n/**\n * Populates metadata fields with the given values. Existing values will be overwritten.\n *\n * @param {Object}   metadata   A list of custom metadata fields (by external_id) and the values to assign to each\n * @param {Array}    public_ids The public IDs of the resources to update\n * @param {Function} callback   Callback function\n * @param {Object}   options    Configuration options\n *\n * @return {Object}\n */\n\n\nexports.update_metadata = function update_metadata(metadata, public_ids, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n  return call_api(\"metadata\", callback, options, function () {\n    var params = {\n      metadata: utils.encode_context(metadata),\n      public_ids: utils.build_array(public_ids),\n      timestamp: utils.timestamp(),\n      type: options.type\n    };\n    return [params];\n  });\n};","map":{"version":3,"sources":["D:/PROJECT ALL/MonkeyFruad/Frontend/node_modules/cloudinary/lib-es5/uploader.js"],"names":["_slicedToArray","sliceIterator","arr","i","_arr","_n","_d","_e","undefined","_i","Symbol","iterator","_s","next","done","push","value","length","err","Array","isArray","Object","TypeError","_extends","assign","target","arguments","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","defineProperty","Constructor","protoProps","staticProps","_classCallCheck","instance","_possibleConstructorReturn","self","ReferenceError","_inherits","subClass","superClass","create","constructor","setPrototypeOf","__proto__","fs","require","_require","extname","basename","Q","Writable","urlLib","_require2","upload_prefix","isSecure","slice","https","Cache","utils","UploadStream","build_upload_params","extend","includes","isObject","isRemoteUrl","merge","pickOnlyExistingValues","exports","unsigned_upload_stream","upload_preset","callback","options","upload_stream","unsigned","upload","stream","unsigned_upload","file","call_api","params","upload_large","path","filename","split","pop","replace","upload_chunked","resource_type","file_reader","createReadStream","out_stream","upload_chunked_stream","pipe","Chunkable","_Writable","_this","getPrototypeOf","chunk_size","buffer","Buffer","alloc","active","on","emit","_write","data","encoding","_this2","concat","grab","upload_large_stream","_unused_","x_unique_upload_id","random_public_id","part_size","chunker","sent","is_last","chunk_start","content_range","timestamp","finished_part","result","errorOrLast","error","write","end","explicit","public_id","build_explicit_api_params","create_archive","target_format","opt","archive_params","create_zip","destroy","type","invalidate","rename","from_public_id","to_public_id","overwrite","to_type","TEXT_PARAMS","text","content","textParams","apply","generate_sprite","tag","transformation","generate_transformation_string","fetch_format","format","async","notification_url","multi","explode","add_tag","public_ids","exclusive","option_consume","command","call_tags_api","remove_tag","remove_all_tags","replace_tag","build_array","add_context","context","call_context_api","remove_all_context","encode_context","cacheResults","_ref","responsive_breakpoints","forEach","_ref2","url","breakpoints","set","raw_transformation","map","width","parseResult","res","JSON","parse","name","jsonError","message","statusCode","action","get_params","deferred","defer","_get_params$call","_get_params$call2","unsigned_params","process_request_params","api_url","boundary","errorRaised","handle_response","reject","d","http_code","resolve","post_data","hashToParameters","filter","_ref3","_ref4","_ref5","_ref6","from","encodeFieldPart","post","promise","file_header","finish_buffer","encodeFilePart","post_options","headers","getUserAgent","method","agent","post_request","request","timeout","setTimeout","abort","postDatum","join","direct_upload","callback_url","hidden_fields","form_attrs","enctype","upload_tag_params","stringify","upload_url","image_upload_tag","field","html_options","html","tag_options","class","html_attrs","unsigned_image_upload_tag","update_metadata","metadata"],"mappings":"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","sourcesContent":["'use strict';\n\nvar _slicedToArray = function () { function sliceIterator(arr, i) { var _arr = []; var _n = true; var _d = false; var _e = undefined; try { for (var _i = arr[Symbol.iterator](), _s; !(_n = (_s = _i.next()).done); _n = true) { _arr.push(_s.value); if (i && _arr.length === i) break; } } catch (err) { _d = true; _e = err; } finally { try { if (!_n && _i[\"return\"]) _i[\"return\"](); } finally { if (_d) throw _e; } } return _arr; } return function (arr, i) { if (Array.isArray(arr)) { return arr; } else if (Symbol.iterator in Object(arr)) { return sliceIterator(arr, i); } else { throw new TypeError(\"Invalid attempt to destructure non-iterable instance\"); } }; }();\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar fs = require('fs');\n\nvar _require = require('path'),\n    extname = _require.extname,\n    basename = _require.basename;\n\nvar Q = require('q');\nvar Writable = require(\"stream\").Writable;\nvar urlLib = require('url');\n\n// eslint-disable-next-line import/order\n\nvar _require2 = require(\"./config\"),\n    upload_prefix = _require2.upload_prefix;\n\nvar isSecure = !(upload_prefix && upload_prefix.slice(0, 5) === 'http:');\nvar https = isSecure ? require('https') : require('http');\n\nvar Cache = require('./cache');\nvar utils = require(\"./utils\");\nvar UploadStream = require('./upload_stream');\n\nvar build_upload_params = utils.build_upload_params,\n    extend = utils.extend,\n    includes = utils.includes,\n    isObject = utils.isObject,\n    isRemoteUrl = utils.isRemoteUrl,\n    merge = utils.merge,\n    pickOnlyExistingValues = utils.pickOnlyExistingValues;\n\n\nexports.unsigned_upload_stream = function unsigned_upload_stream(upload_preset, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return exports.upload_stream(callback, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n\nexports.upload_stream = function upload_stream(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  return exports.upload(null, callback, extend({\n    stream: true\n  }, options));\n};\n\nexports.unsigned_upload = function unsigned_upload(file, upload_preset, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return exports.upload(file, callback, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n\nexports.upload = function upload(file, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"upload\", callback, options, function () {\n    var params = build_upload_params(options);\n    return isRemoteUrl(file) ? [params, { file: file }] : [params, {}, file];\n  });\n};\n\nexports.upload_large = function upload_large(path, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  if (path != null && isRemoteUrl(path)) {\n    // upload a remote file\n    return exports.upload(path, callback, options);\n  }\n  if (path != null && !options.filename) {\n    options.filename = path.split(/(\\\\|\\/)/g).pop().replace(/\\.[^/.]+$/, \"\");\n  }\n  return exports.upload_chunked(path, callback, extend({\n    resource_type: 'raw'\n  }, options));\n};\n\nexports.upload_chunked = function upload_chunked(path, callback, options) {\n  var file_reader = fs.createReadStream(path);\n  var out_stream = exports.upload_chunked_stream(callback, options);\n  return file_reader.pipe(out_stream);\n};\n\nvar Chunkable = function (_Writable) {\n  _inherits(Chunkable, _Writable);\n\n  function Chunkable(options) {\n    _classCallCheck(this, Chunkable);\n\n    var _this = _possibleConstructorReturn(this, (Chunkable.__proto__ || Object.getPrototypeOf(Chunkable)).call(this, options));\n\n    _this.chunk_size = options.chunk_size != null ? options.chunk_size : 20000000;\n    _this.buffer = Buffer.alloc(0);\n    _this.active = true;\n    _this.on('finish', function () {\n      if (_this.active) {\n        _this.emit('ready', _this.buffer, true, function () {});\n      }\n    });\n    return _this;\n  }\n\n  _createClass(Chunkable, [{\n    key: '_write',\n    value: function _write(data, encoding, done) {\n      var _this2 = this;\n\n      if (!this.active) {\n        done();\n      }\n      if (this.buffer.length + data.length <= this.chunk_size) {\n        this.buffer = Buffer.concat([this.buffer, data], this.buffer.length + data.length);\n        done();\n      } else {\n        var grab = this.chunk_size - this.buffer.length;\n        this.buffer = Buffer.concat([this.buffer, data.slice(0, grab)], this.buffer.length + grab);\n        this.emit('ready', this.buffer, false, function (active) {\n          _this2.active = active;\n          if (_this2.active) {\n            _this2.buffer = data.slice(grab);\n            done();\n          }\n        });\n      }\n    }\n  }]);\n\n  return Chunkable;\n}(Writable);\n\nexports.upload_large_stream = function upload_large_stream(_unused_, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return exports.upload_chunked_stream(callback, extend({\n    resource_type: 'raw'\n  }, options));\n};\n\nexports.upload_chunked_stream = function upload_chunked_stream(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  options = extend({}, options, {\n    stream: true\n  });\n  options.x_unique_upload_id = utils.random_public_id();\n  var params = build_upload_params(options);\n  var chunk_size = options.chunk_size != null ? options.chunk_size : options.part_size;\n  var chunker = new Chunkable({\n    chunk_size: chunk_size\n  });\n  var sent = 0;\n  chunker.on('ready', function (buffer, is_last, done) {\n    var chunk_start = sent;\n    sent += buffer.length;\n    options.content_range = `bytes ${chunk_start}-${sent - 1}/${is_last ? sent : -1}`;\n    params.timestamp = utils.timestamp();\n    var finished_part = function finished_part(result) {\n      var errorOrLast = result.error != null || is_last;\n      if (errorOrLast && typeof callback === \"function\") {\n        callback(result);\n      }\n      return done(!errorOrLast);\n    };\n    var stream = call_api(\"upload\", finished_part, options, function () {\n      return [params, {}, buffer];\n    });\n    return stream.write(buffer, 'buffer', function () {\n      return stream.end();\n    });\n  });\n  return chunker;\n};\n\nexports.explicit = function explicit(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"explicit\", callback, options, function () {\n    return utils.build_explicit_api_params(public_id, options);\n  });\n};\n\n// Creates a new archive in the server and returns information in JSON format\nexports.create_archive = function create_archive(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n  var target_format = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : null;\n\n  return call_api(\"generate_archive\", callback, options, function () {\n    var opt = utils.archive_params(options);\n    if (target_format) {\n      opt.target_format = target_format;\n    }\n    return [opt];\n  });\n};\n\n// Creates a new zip archive in the server and returns information in JSON format\nexports.create_zip = function create_zip(callback) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  return exports.create_archive(callback, options, \"zip\");\n};\n\nexports.destroy = function destroy(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"destroy\", callback, options, function () {\n    return [{\n      timestamp: utils.timestamp(),\n      type: options.type,\n      invalidate: options.invalidate,\n      public_id: public_id\n    }];\n  });\n};\n\nexports.rename = function rename(from_public_id, to_public_id, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return call_api(\"rename\", callback, options, function () {\n    return [{\n      timestamp: utils.timestamp(),\n      type: options.type,\n      from_public_id: from_public_id,\n      to_public_id: to_public_id,\n      overwrite: options.overwrite,\n      invalidate: options.invalidate,\n      to_type: options.to_type\n    }];\n  });\n};\n\nvar TEXT_PARAMS = [\"public_id\", \"font_family\", \"font_size\", \"font_color\", \"text_align\", \"font_weight\", \"font_style\", \"background\", \"opacity\", \"text_decoration\", \"font_hinting\", \"font_antialiasing\"];\n\nexports.text = function text(content, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"text\", callback, options, function () {\n    var textParams = pickOnlyExistingValues.apply(undefined, [options].concat(TEXT_PARAMS));\n    var params = _extends({\n      timestamp: utils.timestamp(),\n      text: content\n    }, textParams);\n\n    return [params];\n  });\n};\n\nexports.generate_sprite = function generate_sprite(tag, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"sprite\", callback, options, function () {\n    var transformation = utils.generate_transformation_string(extend({}, options, {\n      fetch_format: options.format\n    }));\n    return [{\n      timestamp: utils.timestamp(),\n      tag: tag,\n      transformation: transformation,\n      async: options.async,\n      notification_url: options.notification_url\n    }];\n  });\n};\n\nexports.multi = function multi(tag, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"multi\", callback, options, function () {\n    var transformation = utils.generate_transformation_string(extend({}, options));\n    return [{\n      timestamp: utils.timestamp(),\n      tag: tag,\n      transformation: transformation,\n      format: options.format,\n      async: options.async,\n      notification_url: options.notification_url\n    }];\n  });\n};\n\nexports.explode = function explode(public_id, callback) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_api(\"explode\", callback, options, function () {\n    var transformation = utils.generate_transformation_string(extend({}, options));\n    return [{\n      timestamp: utils.timestamp(),\n      public_id: public_id,\n      transformation: transformation,\n      format: options.format,\n      type: options.type,\n      notification_url: options.notification_url\n    }];\n  });\n};\n\n// options may include 'exclusive' (boolean) which causes clearing this tag from all other resources\nexports.add_tag = function add_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  var exclusive = utils.option_consume(\"exclusive\", options);\n  var command = exclusive ? \"set_exclusive\" : \"add\";\n  return call_tags_api(tag, command, public_ids, callback, options);\n};\n\nexports.remove_tag = function remove_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return call_tags_api(tag, \"remove\", public_ids, callback, options);\n};\n\nexports.remove_all_tags = function remove_all_tags() {\n  var public_ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var callback = arguments[1];\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_tags_api(null, \"remove_all\", public_ids, callback, options);\n};\n\nexports.replace_tag = function replace_tag(tag) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return call_tags_api(tag, \"replace\", public_ids, callback, options);\n};\n\nfunction call_tags_api(tag, command) {\n  var public_ids = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var callback = arguments[3];\n  var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n  return call_api(\"tags\", callback, options, function () {\n    var params = {\n      timestamp: utils.timestamp(),\n      public_ids: utils.build_array(public_ids),\n      command: command,\n      type: options.type\n    };\n    if (tag != null) {\n      params.tag = tag;\n    }\n    return [params];\n  });\n}\n\nexports.add_context = function add_context(context) {\n  var public_ids = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : [];\n  var callback = arguments[2];\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return call_context_api(context, 'add', public_ids, callback, options);\n};\n\nexports.remove_all_context = function remove_all_context() {\n  var public_ids = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : [];\n  var callback = arguments[1];\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return call_context_api(null, 'remove_all', public_ids, callback, options);\n};\n\nfunction call_context_api(context, command) {\n  var public_ids = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : [];\n  var callback = arguments[3];\n  var options = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n\n  return call_api('context', callback, options, function () {\n    var params = {\n      timestamp: utils.timestamp(),\n      public_ids: utils.build_array(public_ids),\n      command: command,\n      type: options.type\n    };\n    if (context != null) {\n      params.context = utils.encode_context(context);\n    }\n    return [params];\n  });\n}\n\n/**\n * Cache (part of) the upload results.\n * @param result\n * @param {object} options\n * @param {string} options.type\n * @param {string} options.resource_type\n */\nfunction cacheResults(result, _ref) {\n  var type = _ref.type,\n      resource_type = _ref.resource_type;\n\n  if (result.responsive_breakpoints) {\n    result.responsive_breakpoints.forEach(function (_ref2) {\n      var transformation = _ref2.transformation,\n          url = _ref2.url,\n          breakpoints = _ref2.breakpoints;\n      return Cache.set(result.public_id, { type, resource_type, raw_transformation: transformation, format: extname(breakpoints[0].url).slice(1) }, breakpoints.map(function (i) {\n        return i.width;\n      }));\n    });\n  }\n}\n\nfunction parseResult(buffer, res) {\n  var result = '';\n  try {\n    result = JSON.parse(buffer);\n    if (result.error && !result.error.name) {\n      result.error.name = \"Error\";\n    }\n  } catch (jsonError) {\n    result = {\n      error: {\n        message: `Server return invalid JSON response. Status Code ${res.statusCode}. ${jsonError}`,\n        name: \"Error\"\n      }\n    };\n  }\n  return result;\n}\n\nfunction call_api(action, callback, options, get_params) {\n  if (typeof callback !== \"function\") {\n    callback = function callback() {};\n  }\n\n  var deferred = Q.defer();\n  if (options == null) {\n    options = {};\n  }\n\n  var _get_params$call = get_params.call(),\n      _get_params$call2 = _slicedToArray(_get_params$call, 3),\n      params = _get_params$call2[0],\n      unsigned_params = _get_params$call2[1],\n      file = _get_params$call2[2];\n\n  params = utils.process_request_params(params, options);\n  params = extend(params, unsigned_params);\n  var api_url = utils.api_url(action, options);\n  var boundary = utils.random_public_id();\n  var errorRaised = false;\n  var handle_response = function handle_response(res) {\n    // let buffer;\n    if (errorRaised) {\n\n      // Already reported\n    } else if (res.error) {\n      errorRaised = true;\n      deferred.reject(res);\n      callback(res);\n    } else if (includes([200, 400, 401, 404, 420, 500], res.statusCode)) {\n      var buffer = \"\";\n      res.on(\"data\", function (d) {\n        buffer += d;\n        return buffer;\n      });\n      res.on(\"end\", function () {\n        var result = void 0;\n        if (errorRaised) {\n          return;\n        }\n        result = parseResult(buffer, res);\n        if (result.error) {\n          result.error.http_code = res.statusCode;\n          deferred.reject(result.error);\n        } else {\n          cacheResults(result, options);\n          deferred.resolve(result);\n        }\n        callback(result);\n      });\n      res.on(\"error\", function (error) {\n        errorRaised = true;\n        deferred.reject(error);\n        callback({ error });\n      });\n    } else {\n      var error = {\n        message: `Server returned unexpected status code - ${res.statusCode}`,\n        http_code: res.statusCode,\n        name: \"UnexpectedResponse\"\n      };\n      deferred.reject(error);\n      callback({ error });\n    }\n  };\n  var post_data = utils.hashToParameters(params).filter(function (_ref3) {\n    var _ref4 = _slicedToArray(_ref3, 2),\n        key = _ref4[0],\n        value = _ref4[1];\n\n    return value != null;\n  }).map(function (_ref5) {\n    var _ref6 = _slicedToArray(_ref5, 2),\n        key = _ref6[0],\n        value = _ref6[1];\n\n    return Buffer.from(encodeFieldPart(boundary, key, value), 'utf8');\n  });\n\n  var result = post(api_url, post_data, boundary, file, handle_response, options);\n  if (isObject(result)) {\n    return result;\n  }\n  return deferred.promise;\n}\n\nfunction post(url, post_data, boundary, file, callback, options) {\n  var file_header = void 0;\n  var finish_buffer = Buffer.from(\"--\" + boundary + \"--\", 'ascii');\n  if (file != null || options.stream) {\n    // eslint-disable-next-line no-nested-ternary\n    var filename = options.stream ? options.filename ? options.filename : \"file\" : basename(file);\n    file_header = Buffer.from(encodeFilePart(boundary, 'application/octet-stream', 'file', filename), 'binary');\n  }\n  var post_options = urlLib.parse(url);\n  var headers = {\n    'Content-Type': `multipart/form-data; boundary=${boundary}`,\n    'User-Agent': utils.getUserAgent()\n  };\n  if (options.content_range != null) {\n    headers['Content-Range'] = options.content_range;\n  }\n  if (options.x_unique_upload_id != null) {\n    headers['X-Unique-Upload-Id'] = options.x_unique_upload_id;\n  }\n  post_options = extend(post_options, {\n    method: 'POST',\n    headers: headers\n  });\n  if (options.agent != null) {\n    post_options.agent = options.agent;\n  }\n  var post_request = https.request(post_options, callback);\n  var upload_stream = new UploadStream({ boundary });\n  upload_stream.pipe(post_request);\n  var timeout = false;\n  post_request.on(\"error\", function (error) {\n    if (timeout) {\n      error = {\n        message: \"Request Timeout\",\n        http_code: 499,\n        name: \"TimeoutError\"\n      };\n    }\n    return callback({ error });\n  });\n  post_request.setTimeout(options.timeout != null ? options.timeout : 60000, function () {\n    timeout = true;\n    return post_request.abort();\n  });\n  post_data.forEach(function (postDatum) {\n    return post_request.write(postDatum);\n  });\n  if (options.stream) {\n    post_request.write(file_header);\n    return upload_stream;\n  }\n  if (file != null) {\n    post_request.write(file_header);\n    fs.createReadStream(file).on('error', function (error) {\n      callback({\n        error: error\n      });\n      return post_request.abort();\n    }).pipe(upload_stream);\n  } else {\n    post_request.write(finish_buffer);\n    post_request.end();\n  }\n  return true;\n}\n\nfunction encodeFieldPart(boundary, name, value) {\n  return [`--${boundary}`, `Content-Disposition: form-data; name=\"${name}\"`, '', value, ''].join(\"\\r\\n\");\n}\n\nfunction encodeFilePart(boundary, type, name, filename) {\n  return [`--${boundary}`, `Content-Disposition: form-data; name=\"${name}\"; filename=\"${filename}\"`, `Content-Type: ${type}`, '', ''].join(\"\\r\\n\");\n}\n\nexports.direct_upload = function direct_upload(callback_url) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var params = build_upload_params(extend({\n    callback: callback_url\n  }, options));\n  params = utils.process_request_params(params, options);\n  var api_url = utils.api_url(\"upload\", options);\n  return {\n    hidden_fields: params,\n    form_attrs: {\n      action: api_url,\n      method: \"POST\",\n      enctype: \"multipart/form-data\"\n    }\n  };\n};\n\nexports.upload_tag_params = function upload_tag_params() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  var params = build_upload_params(options);\n  params = utils.process_request_params(params, options);\n  return JSON.stringify(params);\n};\n\nexports.upload_url = function upload_url() {\n  var options = arguments.length > 0 && arguments[0] !== undefined ? arguments[0] : {};\n\n  if (options.resource_type == null) {\n    options.resource_type = \"auto\";\n  }\n  return utils.api_url(\"upload\", options);\n};\n\nexports.image_upload_tag = function image_upload_tag(field) {\n  var options = arguments.length > 1 && arguments[1] !== undefined ? arguments[1] : {};\n\n  var html_options = options.html || {};\n  var tag_options = extend({\n    type: \"file\",\n    name: \"file\",\n    \"data-url\": exports.upload_url(options),\n    \"data-form-data\": exports.upload_tag_params(options),\n    \"data-cloudinary-field\": field,\n    \"data-max-chunk-size\": options.chunk_size,\n    \"class\": [html_options.class, \"cloudinary-fileupload\"].join(\" \")\n  }, html_options);\n  return `<input ${utils.html_attrs(tag_options)}/>`;\n};\n\nexports.unsigned_image_upload_tag = function unsigned_image_upload_tag(field, upload_preset) {\n  var options = arguments.length > 2 && arguments[2] !== undefined ? arguments[2] : {};\n\n  return exports.image_upload_tag(field, merge(options, {\n    unsigned: true,\n    upload_preset: upload_preset\n  }));\n};\n\n/**\n * Populates metadata fields with the given values. Existing values will be overwritten.\n *\n * @param {Object}   metadata   A list of custom metadata fields (by external_id) and the values to assign to each\n * @param {Array}    public_ids The public IDs of the resources to update\n * @param {Function} callback   Callback function\n * @param {Object}   options    Configuration options\n *\n * @return {Object}\n */\nexports.update_metadata = function update_metadata(metadata, public_ids, callback) {\n  var options = arguments.length > 3 && arguments[3] !== undefined ? arguments[3] : {};\n\n  return call_api(\"metadata\", callback, options, function () {\n    var params = {\n      metadata: utils.encode_context(metadata),\n      public_ids: utils.build_array(public_ids),\n      timestamp: utils.timestamp(),\n      type: options.type\n    };\n    return [params];\n  });\n};"]},"metadata":{},"sourceType":"script"}